{% extends "layout.html" %}
{% block body %}
<script type=text/javascript src="{{ url_for('static', filename='jquery.flot.js') }}"></script>
<script type=text/javascript src="{{ url_for('static', filename='jquery.flot.selection.js') }}"></script>
<script type=text/javascript>
  var initialized = 0;
  $(function () { updatePlot(); });

  function updatePlot() {
    $.getJSON($SCRIPT_ROOT + '/_getdata', {"hwid": "{{ hwid }}"}, function(result) {

        var datastreams = result.data.datastreams;

        // Create the plot divs
        if(initialized == 0)
        {
          var plotdivs = '';
          for(name in datastreams)
          {
            plotdivs += "<hr/>";
            plotdivs += "<p style=\"font-size:20pt;\">";
            if(name == "temperature" || name == "humidity" || name == "light")
              plotdivs += "<img src=\"/static/"+name+"_icon.svg\"/ style=\"height:20px;\"\>";
            plotdivs += " " + name+"</p>";
            plotdivs += "<div id=\""+name+"\" style=\"width:600px;height:150px;\"></div>";
          }
          $("#plots").html(plotdivs)
        }
        initialized = 1;

        // Plot all that data
        for(name in datastreams)
        {
          var datastream = datastreams[name];
          $.plot($("#"+name), [
              {
                data: datastream,
                lines: {show: true, fill: true},
                shadowSize: 0
                }], {xaxis: {mode: "time"}});
              
              
              
              
              //datastream], 
              //{xaxis: {mode: "time"},
              // lines: {show: true, fill: true}
              //});
        }
  
        });
  
    // Update once per second
    setTimeout("updatePlot()", 1000);
  }


</script>

<div style="font-size:30pt;">Device : {{ hwid }}</div>  
<a href="{{ url_for('myceres') }}">&lt;&lt; back</a>
<div id="plots"></div>

{% endblock %}

